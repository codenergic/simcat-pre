(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{236:function(e,n,t){"use strict";t.r(n);t(5),t(3),t(2),t(1),t(4),t(62);var r=t(19),o=t(0),c=t(102),l={props:{name:{type:String,default:""},channel:{type:String,default:null},channels:{type:Array,default:function(){return[]}}},data:function(){return{newChannel:""}},computed:{newChannelValid:function(){return""!==this.newChannel.trim()}},methods:{createChannel:function(){this.newChannelValid&&(this.$emit("new-channel",this.newChannel),this.$bvModal.hide("new-channel"))}}},h=t(44),d=Object(h.a)(l,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("b-form-group",[t("label",{attrs:{for:"name"}},[e._v("Name")]),e._v(" "),t("b-form-input",{attrs:{id:"name",value:e.name,autofocus:""},on:{input:function(n){return e.$emit("update:name",n)}}})],1),e._v(" "),t("b-form-group",[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-channel",modifiers:{"new-channel":!0}}],staticClass:"float-right",attrs:{disabled:""===e.name.trim(),size:"sm",variant:"link"}},[e._v("\n      Create new\n    ")]),e._v(" "),t("label",{attrs:{for:"channel"}},[e._v("\n      Channel\n    ")]),e._v(" "),t("b-form-select",{attrs:{id:"channel",disabled:""===e.name.trim(),value:e.channel,options:e.channels},on:{input:function(n){e.$emit("update:channel",n),e.$emit("channel-change",n)}}})],1),e._v(" "),t("b-modal",{attrs:{id:"new-channel","hide-header":"","hide-footer":""}},[t("b-form",{on:{submit:function(n){return n.preventDefault(),n.stopPropagation(),e.createChannel(n)}}},[t("b-form-group",[t("label",{attrs:{for:"new-channel"}},[e._v("Channel Name")]),e._v(" "),t("b-form-input",{attrs:{id:"new-channel",autofocus:""},model:{value:e.newChannel,callback:function(n){e.newChannel=n},expression:"newChannel"}})],1),e._v(" "),t("b-form-group",[t("b-button",{staticClass:"float-right",attrs:{type:"submit",variant:"primary",disabled:!e.newChannelValid}},[e._v("\n          Create\n        ")])],1)],1)],1)],1)}),[],!1,null,null,null).exports,f={props:{sender:{type:String,default:null},message:{type:String,default:null},op:{type:Boolean,default:!1}}};function m(object,e){var n=Object.keys(object);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(object);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),n.push.apply(n,t)}return n}function w(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(source,!0).forEach((function(n){Object(o.a)(e,n,source[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(source).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(source,n))}))}return e}var v,y,C,_={components:{ChannelBox:d,MessageBox:Object(h.a)(f,(function(){var e=this.$createElement,n=this._self._c||e;return n("b-alert",{class:(this.op?"offset-sm-3":"")+" col-sm-9 mb-1 py-1 px-2",attrs:{variant:this.op?"primary":"secondary",show:""}},[n("div",[n("strong",{domProps:{textContent:this._s(this.sender)}})]),this._v(" "),n("div",{domProps:{textContent:this._s(this.message)}})])}),[],!1,null,null,null).exports},data:function(){return{content:"",window:{width:0,height:0}}},computed:w({currentMessages:function(){var e=this;return this.messages.filter((function(n){return n.channel===e.current.channel}))},senderValid:function(){return""!==this.current.sender.trim()}},Object(c.d)({current:function(e){return e.current},connected:function(e){return e.connected},channels:function(e){return e.channels},messages:function(e){return e.messages}})),watch:{currentMessages:function(){setTimeout(this.scrollDown,100)}},mounted:(C=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connect();case 2:return e.next=4,this.getChannels();case 4:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)}),beforeMount:function(){window.addEventListener("resize",this.handleResize),this.handleResize()},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)},methods:w({connectAndGetMessage:(y=Object(r.a)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connectToChannel(n);case 2:if(!(this.currentMessages.length<1&&""!==n)){e.next=5;break}return e.next=5,this.getMessages(n);case 5:this.scrollDown();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)}),scrollDown:function(){var e=this.$refs["message-box"];e.scrollTop=e.scrollHeight},submitMessage:(v=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendMessage({content:this.content,sender:this.current.sender,channel:this.current.channel});case 2:this.content="";case 3:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)}),handleResize:function(){this.window.width=window.innerWidth,this.window.height=window.innerHeight}},Object(c.c)(["setCurrentChannel","setCurrentSender"]),{},Object(c.b)(["connect","connectToChannel","getChannels","getMessages","sendMessage"]))},x=Object(h.a)(_,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return e.connected?t("div",{staticStyle:{"margin-top":"70px"}},[t("b-navbar",{attrs:{fixed:"top",variant:"dark",type:"dark"}},[t("b-container",[t("b-navbar-brand",[e._v("Simcat")])],1)],1),e._v(" "),t("b-container",[t("b-row",[t("b-col",{attrs:{sm:"12"}},[t("channel-box",{attrs:{channels:e.channels,name:e.current.sender,channel:e.current.channel},on:{"update:name":e.setCurrentSender,"update:channel":e.setCurrentChannel,"channel-change":e.connectAndGetMessage,"new-channel":function(n){e.getMessages(n).then((function(t){return e.setCurrentChannel(n)}))}}})],1)],1),e._v(" "),t("b-row",[t("b-col",{style:{height:e.window.height-300+"px"},attrs:{sm:"12"}},[t("div",{ref:"message-box",staticClass:"overflow-auto",staticStyle:{height:"100%"}},e._l(e.currentMessages,(function(n,r){return t("message-box",{key:"message-"+r,staticClass:"col-sm-9 mb-1",attrs:{message:n.content,sender:n.sender,op:n.sender===e.current.sender,"body-class":"py-1 px-0"}})})),1)])],1)],1),e._v(" "),t("div",{staticClass:"fixed-bottom"},[t("b-container",[t("b-form",{on:{submit:function(n){return n.preventDefault(),e.submitMessage()}}},[t("b-form-group",[t("b-input-group",[t("b-form-input",{staticClass:"my-6",attrs:{placeholder:"Message...",disabled:""===e.current.channel||!e.senderValid},model:{value:e.content,callback:function(n){e.content=n},expression:"content"}}),e._v(" "),t("b-input-group-append",[t("b-button",{attrs:{variant:"primary",type:"submit",disabled:""===e.current.channel||!e.senderValid}},[e._v("\n                Send\n              ")])],1)],1)],1)],1)],1)],1)],1):e._e()}),[],!1,null,null,null);n.default=x.exports}}]);